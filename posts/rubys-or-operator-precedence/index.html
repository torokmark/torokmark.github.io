<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta itemprop="name" content="Ruby&#39;s or operator precedence">
<meta itemprop="description" content="Operators have precedence and sometimes they can give us hard time to figure out why our code works as it does.
Ruby has three or operators, |, ||, and the readable or. All of them have different precedences. That is, the precedence, that makes some trouble if we do not care about which one we use.
The evaluation of logical operators are left-associative, that means the far left operator is evaluated at first, than its result will be the left operand of the next operator and so on."><meta itemprop="datePublished" content="2019-08-23T12:00:00+01:00" />
<meta itemprop="dateModified" content="2019-08-23T12:00:00+01:00" />
<meta itemprop="wordCount" content="492">
<meta itemprop="keywords" content="or operator,operator precedence," /><meta property="og:title" content="Ruby&#39;s or operator precedence" />
<meta property="og:description" content="Operators have precedence and sometimes they can give us hard time to figure out why our code works as it does.
Ruby has three or operators, |, ||, and the readable or. All of them have different precedences. That is, the precedence, that makes some trouble if we do not care about which one we use.
The evaluation of logical operators are left-associative, that means the far left operator is evaluated at first, than its result will be the left operand of the next operator and so on." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://torokmark.github.io/posts/rubys-or-operator-precedence/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-08-23T12:00:00+01:00" />
<meta property="article:modified_time" content="2019-08-23T12:00:00+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ruby&#39;s or operator precedence"/>
<meta name="twitter:description" content="Operators have precedence and sometimes they can give us hard time to figure out why our code works as it does.
Ruby has three or operators, |, ||, and the readable or. All of them have different precedences. That is, the precedence, that makes some trouble if we do not care about which one we use.
The evaluation of logical operators are left-associative, that means the far left operator is evaluated at first, than its result will be the left operand of the next operator and so on."/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>Ruby&#39;s or operator precedence</title>
	<link rel="stylesheet" href="https://torokmark.github.io/css/style.min.037b6ee8f8c1baab6a3d0a9da11c3ff18a7552471f16c59fd98538d5ce99208b.css" integrity="sha256-A3tu6PjBuqtqPQqdoRw/8Yp1UkcfFsWf2YU41c6ZIIs=" crossorigin="anonymous">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://torokmark.github.io">T[h]ink]er[ing</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="https://torokmark.github.io/posts">Posts</a>
				<a href="https://torokmark.github.io/about">About</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<span class="hdr-social hide-in-mobile"><a href="https://github.com/torokmark" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://torokmark.github.io/posts">Posts</a></li>
			<li><a href="https://torokmark.github.io/about">About</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Aug 23, 2019</span></div>
				<h1>Ruby&#39;s or operator precedence</h1>
			</header>
			<div class="content">
				<p><strong>Operators have precedence and sometimes they can give us hard time to figure
out why our code works as it does.</strong></p>
<p>Ruby has three <em>or</em> operators, <code>|</code>, <code>||</code>, and the readable <code>or</code>. All of them
have different precedences. That is, the precedence, that makes some trouble if
we do not care about which one we use.</p>
<p>The evaluation of logical operators are left-associative, that means the far left
operator is evaluated at first, than its result will be the left operand of the
next operator and so on. <code>|</code> operator evaluates both operands, while <code>||</code> or <code>or</code>
are short-circuit operators.</p>
<p>There are two falsy values in the language, <code>false</code> and <code>nil</code>, anything else belong
to the truthy set. <code>|</code> operator works as expected and returns logical values.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">puts</span> <span class="kp">false</span> <span class="o">|</span> <span class="kp">nil</span>  <span class="c1"># false</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="kp">true</span> <span class="o">|</span> <span class="kp">nil</span>   <span class="c1"># true</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">2</span>   <span class="c1"># true</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">3</span>   <span class="c1"># false, here 3 is consider as an int value, not a logical value  </span>
</span></span></code></pre></div><p>In case of <code>||</code> and <code>or</code> operators returned value is not logical, as it would be in case of <code>|</code>.
Nothing has suprised us!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">puts</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">||</span> <span class="mi">3</span>  <span class="c1"># 3</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="mi">3</span> <span class="o">||</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span>  <span class="c1"># true</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="mi">3</span>  <span class="c1"># 3</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="mi">3</span> <span class="ow">or</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span>  <span class="c1"># true</span>
</span></span></code></pre></div><p>Let us see a bit more complex example and examine the results. Since both <code>||</code>
and <code>or</code> are lazy operators, if left-hand side operand is true, the right-hand
side operand won&rsquo;t be evaluated, hence we understand why empty string is
emitted instead of <code>3</code> in place of <code>b</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">||</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="s2">&#34;|| &#39;</span><span class="si">#{</span> <span class="n">a</span> <span class="si">}</span><span class="s2">&#39; &#39;</span><span class="si">#{</span> <span class="n">b</span> <span class="si">}</span><span class="s2">&#39;&#34;</span>  <span class="c1"># || &#39;2&#39; &#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="s2">&#34;or &#39;</span><span class="si">#{</span> <span class="n">a</span> <span class="si">}</span><span class="s2">&#39; &#39;</span><span class="si">#{</span> <span class="n">b</span> <span class="si">}</span><span class="s2">&#39;&#34;</span>  <span class="c1"># or &#39;2&#39; &#39;&#39;</span>
</span></span></code></pre></div><p>What if the right-hand side operator is also evaluated, since the result of the
expression is <code>false</code> on the left.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="kp">false</span> <span class="o">||</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="s2">&#34;|| &#39;</span><span class="si">#{</span> <span class="n">a</span> <span class="si">}</span><span class="s2">&#39; &#39;</span><span class="si">#{</span> <span class="n">b</span> <span class="si">}</span><span class="s2">&#39;&#34;</span>  <span class="c1"># || &#39;3&#39; &#39;3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="kp">false</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span>  
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="s2">&#34;or &#39;</span><span class="si">#{</span> <span class="n">a</span> <span class="si">}</span><span class="s2">&#39; &#39;</span><span class="si">#{</span> <span class="n">b</span> <span class="si">}</span><span class="s2">&#39;&#34;</span>  <span class="c1"># or &#39;false&#39; &#39;3&#39;</span>
</span></span></code></pre></div><p>Uhh, quite wierd results. Not just they are different, but the value of <code>a</code> is
the same as the value of <code>b</code>. Where is <code>false</code>?</p>
<p>The trick is that the precedence of <code>||</code> is higher than the precedence of <code>=</code> (assign),
but the precedence of <code>=</code> is higher than the precedence of <code>or</code>.</p>
<p>According to the abovementioned lines, the evaluation of <code>||</code> looks as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="kp">false</span> <span class="o">||</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">(</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">3</span>
</span></span></code></pre></div><p><em>And</em> operators, like <code>&amp;</code>, <code>&amp;&amp;</code>, and <code>and</code>, work similar.</p>
<p><strong>As we see the precedence of operators can cause a big mess if we are not circumspect enough.
Though, if it is possible, use <code>||</code> operator and be careful.</strong></p>
<p>Sample can be found: <a href="https://gist.github.com/torokmark/8347c58f0cda918e99cb43fba84aea81">https://gist.github.com/torokmark/8347c58f0cda918e99cb43fba84aea81</a></p>

			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://torokmark.github.io/tags/or-operator">or operator</a></span><span class="tag"><a href="https://torokmark.github.io/tags/operator-precedence">operator precedence</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>492 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2019-08-23 13:00 &#43;0200</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="next-post" href="https://torokmark.github.io/posts/do-you-know-java-single-source-file-code/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;Newer</span><br><span>Do you know Java: Single Source File Code</span>
			</a>
			<a class="prev-post" href="https://torokmark.github.io/posts/container-types-in-shell-script/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Container types in shell script</span>
			</a>
		</div>
		<div id="comments" class="thin">
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2023 <a href="https://torokmark.github.io">Mark Torok</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://torokmark.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>



	<script src="https://torokmark.github.io/js/bundle.min.580988ed2982bcbb74a1773c7abea97b43e4c43b9324e10cda0813ec6ec4bb67.js" integrity="sha256-WAmI7SmCvLt0oXc8er6pe0PkxDuTJOEM2ggT7G7Eu2c=" crossorigin="anonymous"></script>
	

</body>

</html>
