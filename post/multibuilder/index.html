<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

        
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

        <link href="https://fonts.googleapis.com/css?family=Ubuntu|Ubuntu+Mono" rel="stylesheet"> 

        <title>The Multibuilder Pattern</title>

        <link rel="stylesheet" href="/css/stylesheet.css">
    </head>
    <body>
      <div class="container-fluid">
        <nav class="navbar navbar-expand-md navbar-light">

          
          <span class="navbar-brand mb-0 h1"></span>

          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle Navigation" name="button">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
              <a class="nav-item nav-link " href="/">Home</a>
              
              
              <a class="nav-item nav-link " href="/about/">About</a>
            </div>
          </div>
        </nav>

        <section id="page-title">
          <h1><a href="/">T[h]inking</a></h1>
          <span id="author-name">
            <h6><a href="/about/"></a></h6>
          </span>
        </section>


<div class="blog-post">
  <h1>The Multibuilder Pattern</h1>
  <div class="blog-post-subheader">
    <time>08 Jan 2019</time>
  </div>
  <div class="blog-post-content">
    

<p><strong>In this post I would like to present a couple of solutions for builder pattern in python,
and finally I show how I implemented an amazing and extraordinary builder that I call multibuilder pattern.</strong></p>

<p>Builder pattern comes in handy when we need to set a lot of fields of an object and we do not want to use many methods with multiple parameters.</p>

<p>All implementations are found in this repo: <a href="https://github.com/torokmark/builders_in_python">https://github.com/torokmark/builders_in_python</a></p>

<h2 id="the-simple-one">The Simple One</h2>

<p><strong>Task</strong>: Let us implement a <code>Person</code> with the following fields like <code>name</code>, <code>age</code>, <code>phone</code>.<br />
<strong>Approach</strong>: Make a <code>PersonBuilder</code> with methods according to the fields in <code>Person</code>, plus a <code>build</code> which returns an object of <code>Person</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span>:
    <span style="color:#66d9ef">def</span> __init__(self, name, age, phone):
        self<span style="color:#f92672">.</span>_name <span style="color:#f92672">=</span> name
        self<span style="color:#f92672">.</span>_age <span style="color:#f92672">=</span> age
        self<span style="color:#f92672">.</span>_phone <span style="color:#f92672">=</span> phone

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">name</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_name

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">age</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_age
    
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">phone</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_phone

    <span style="color:#66d9ef">def</span> __str__(self):
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;[name={}; age={}; phone={}]&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>_name, self<span style="color:#f92672">.</span>_age, self<span style="color:#f92672">.</span>_phone)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PersonBuilder</span>:
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;John Doe&#39;</span>
        self<span style="color:#f92672">.</span>_age <span style="color:#f92672">=</span> <span style="color:#ae81ff">99</span>
        self<span style="color:#f92672">.</span>_phone <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;000&#39;</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">name</span>(self, name):
        self<span style="color:#f92672">.</span>_name <span style="color:#f92672">=</span> name
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">age</span>(self, age):
        self<span style="color:#f92672">.</span>_age <span style="color:#f92672">=</span> age
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">phone</span>(self, phone):
        self<span style="color:#f92672">.</span>_phone <span style="color:#f92672">=</span> phone
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(self):
        <span style="color:#66d9ef">return</span> Person(self<span style="color:#f92672">.</span>_name, self<span style="color:#f92672">.</span>_age, self<span style="color:#f92672">.</span>_phone)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    <span style="color:#66d9ef">print</span>(PersonBuilder()
        <span style="color:#f92672">.</span>name(<span style="color:#e6db74">&#39;jancsi&#39;</span>)
        <span style="color:#f92672">.</span>age(<span style="color:#ae81ff">12</span>)
        <span style="color:#f92672">.</span>phone(<span style="color:#e6db74">&#39;11223344&#39;</span>)
        <span style="color:#f92672">.</span>age(<span style="color:#ae81ff">18</span>)
        <span style="color:#f92672">.</span>build())            
    <span style="color:#75715e"># =&gt; [name=jancsi; age=18; phone=11223344]</span>
    <span style="color:#66d9ef">print</span>(PersonBuilder()
        <span style="color:#f92672">.</span>age(<span style="color:#ae81ff">12</span>)
        <span style="color:#f92672">.</span>phone(<span style="color:#e6db74">&#39;11223344&#39;</span>)
        <span style="color:#f92672">.</span>age(<span style="color:#ae81ff">18</span>)
        <span style="color:#f92672">.</span>build())            
    <span style="color:#75715e"># =&gt; [name=John Doe; age=18; phone=11223344]</span>
    <span style="color:#66d9ef">print</span>(PersonBuilder()
        <span style="color:#f92672">.</span>build())            
    <span style="color:#75715e"># =&gt; [name=John Doe; age=99; phone=000]</span></code></pre></div>
<h2 id="the-one-with-named-parameters">The One with Named Parameters</h2>

<p>Though builder is very flexible, it is inevitable to have some default values for those fields that are not set during the building.</p>

<p><strong>Task</strong>: How to do this without builder?<br />
<strong>Approach</strong>: Let us use default values in constructor parameter list.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span>:
    <span style="color:#66d9ef">def</span> __init__(self, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;John Doe&#39;</span>, age<span style="color:#f92672">=</span><span style="color:#ae81ff">99</span>, phone<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;000&#39;</span>):
        self<span style="color:#f92672">.</span>_name <span style="color:#f92672">=</span> name
        self<span style="color:#f92672">.</span>_age <span style="color:#f92672">=</span> age
        self<span style="color:#f92672">.</span>_phone <span style="color:#f92672">=</span> phone

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">name</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_name

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">age</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_age
    
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">phone</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_phone

    <span style="color:#66d9ef">def</span> __str__(self):
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;[name={}; age={}; phone={}]&#39;</span><span style="color:#f92672">.</span>format(
          self<span style="color:#f92672">.</span>_name, 
          self<span style="color:#f92672">.</span>_age, 
          self<span style="color:#f92672">.</span>_phone)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    <span style="color:#66d9ef">print</span>(Person())                        
    <span style="color:#75715e"># =&gt; [name=John Doe; age=99; phone=000]</span>
    <span style="color:#66d9ef">print</span>(Person(phone<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;123456&#39;</span>, age<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>))  
    <span style="color:#75715e"># =&gt; [name=John Doe; age=45; phone=123456]</span>
    <span style="color:#66d9ef">print</span>(Person(<span style="color:#e6db74">&#39;jancsi&#39;</span>, <span style="color:#ae81ff">54</span>, <span style="color:#e6db74">&#39;312333&#39;</span>))  
    <span style="color:#75715e"># =&gt; [name=jancsi; age=54; phone=312333]</span></code></pre></div>
<h2 id="the-classic">The Classic</h2>

<p><strong>Task</strong>: Let us implement a classic car builder.<br />
<strong>Solution</strong>: Take the example from <em>Gang of Four</em>!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Car</span>:
    <span style="color:#66d9ef">def</span> __init__(self, wheel<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, seat<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>):
        self<span style="color:#f92672">.</span>wheel <span style="color:#f92672">=</span> wheel
        self<span style="color:#f92672">.</span>seat <span style="color:#f92672">=</span> seat
        self<span style="color:#f92672">.</span>color <span style="color:#f92672">=</span> color

    <span style="color:#66d9ef">def</span> __str__(self):
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;[wheels: {}, seats: {}, color: {}]&#39;</span><span style="color:#f92672">.</span>format(
          self<span style="color:#f92672">.</span>wheel, 
          self<span style="color:#f92672">.</span>seat, 
          self<span style="color:#f92672">.</span>color)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Builder</span>:
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_wheels</span>(self, wheel): <span style="color:#66d9ef">pass</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_seats</span>(self, seat): <span style="color:#66d9ef">pass</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_color</span>(self, color): <span style="color:#66d9ef">pass</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CarBuilder</span>(Builder):

    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>car <span style="color:#f92672">=</span> Car()

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_wheels</span>(self, wheel):
        self<span style="color:#f92672">.</span>car<span style="color:#f92672">.</span>wheel <span style="color:#f92672">=</span> wheel

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_seats</span>(self, seat):
        self<span style="color:#f92672">.</span>car<span style="color:#f92672">.</span>seat <span style="color:#f92672">=</span> seat

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_color</span>(self, color):
        self<span style="color:#f92672">.</span>car<span style="color:#f92672">.</span>color <span style="color:#f92672">=</span> color

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_result</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>car</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CarBuilderDirector</span>:
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(self):
        builder <span style="color:#f92672">=</span> CarBuilder()
        builder<span style="color:#f92672">.</span>set_wheels(<span style="color:#ae81ff">8</span>)
        builder<span style="color:#f92672">.</span>set_seats(<span style="color:#ae81ff">4</span>)
        builder<span style="color:#f92672">.</span>set_color(<span style="color:#e6db74">&#34;Red&#34;</span>)
        <span style="color:#66d9ef">return</span> builder<span style="color:#f92672">.</span>get_result()</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    car <span style="color:#f92672">=</span> CarBuilderDirector()<span style="color:#f92672">.</span>build()
    <span style="color:#66d9ef">print</span>(car)      
    <span style="color:#75715e"># =&gt; [wheels: 8, seats: 4, color: Red]</span></code></pre></div>
<h2 id="the-builder-with-builders">The Builder with Builders</h2>

<p><strong>Task</strong>: Implement a <em>Response object</em> builder. It has a status code, a header and a body part. Create a builder that can build multiple part of an object.<br />
<strong>Approach</strong>: Let us implement so called subbuilders and pass the created objects to an outer builder, which combines them together.</p>

<blockquote>
<p>Using just <code>HeaderBuilder#add(key, value)</code> instead of using header specific setters.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Builder</span>:
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(self): <span style="color:#66d9ef">pass</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HeaderBuilder</span>(Builder):
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>_header <span style="color:#f92672">=</span> {}

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(self, key, value):
        self<span style="color:#f92672">.</span>_header[key] <span style="color:#f92672">=</span> value
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_header</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BodyBuilder</span>(Builder):
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>_body <span style="color:#f92672">=</span> []

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(self, content):
        self<span style="color:#f92672">.</span>_body<span style="color:#f92672">.</span>append(content)
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_body</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ResponseBuilder</span>(Builder):
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>_header <span style="color:#f92672">=</span> None
        self<span style="color:#f92672">.</span>_body <span style="color:#f92672">=</span> None
        self<span style="color:#f92672">.</span>_status <span style="color:#f92672">=</span> None

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">header</span>(self, header):
        self<span style="color:#f92672">.</span>_header <span style="color:#f92672">=</span> header
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">body</span>(self, body):
        self<span style="color:#f92672">.</span>_body <span style="color:#f92672">=</span> body
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">status</span>(self, status):
        self<span style="color:#f92672">.</span>_status <span style="color:#f92672">=</span> status
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(self):
        ret <span style="color:#f92672">=</span> {}
        ret[<span style="color:#e6db74">&#39;statusCode&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_status
        ret[<span style="color:#e6db74">&#39;header&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_header
        ret[<span style="color:#e6db74">&#39;body&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_body
        <span style="color:#66d9ef">return</span> ret</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    <span style="color:#66d9ef">print</span>(ResponseBuilder()
            <span style="color:#f92672">.</span>header(
                HeaderBuilder()
                    <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;Accept&#39;</span>, <span style="color:#e6db74">&#39;*&#39;</span>)
                    <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;Age&#39;</span>, <span style="color:#ae81ff">12</span>)
                    <span style="color:#f92672">.</span>build()
            )
            <span style="color:#f92672">.</span>body(
                BodyBuilder()
                    <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;some message comes here&#39;</span>)
                    <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;another message here...&#39;</span>)
                    <span style="color:#f92672">.</span>build()
            )
            <span style="color:#f92672">.</span>status(<span style="color:#ae81ff">200</span>)
            <span style="color:#f92672">.</span>build()
    )                   
    <span style="color:#75715e"># =&gt; {&#39;statusCode&#39;: 200, &#39;header&#39;: {&#39;Accept&#39;: &#39;*&#39;, &#39;Age&#39;: 12}, &#39;body&#39;: [&#39;some message comes here&#39;, &#39;another message here...&#39;]}</span></code></pre></div>
<h2 id="the-multibuilder">The Multibuilder</h2>

<p><strong>Task</strong>: Create a builder that can build multiple part of an object at one time whitout using so called subbuilders.<br />
<strong>Approach</strong>: Let us chain everything up and memorize the already created objects.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HeaderBuilder</span>:
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>_header <span style="color:#f92672">=</span> {}

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(self, key, value):
        self<span style="color:#f92672">.</span>_header[key] <span style="color:#f92672">=</span> value
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">body</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_body

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>status(<span style="color:#ae81ff">200</span>)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">status</span>(self, code):
        ret <span style="color:#f92672">=</span> {}
        ret[<span style="color:#e6db74">&#39;status&#39;</span>] <span style="color:#f92672">=</span> code
        ret[<span style="color:#e6db74">&#39;header&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_header
        ret[<span style="color:#e6db74">&#39;body&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_body<span style="color:#f92672">.</span>__dict__<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;_body&#39;</span>)
        <span style="color:#66d9ef">return</span> ret

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_body</span>(self, body):
        self<span style="color:#f92672">.</span>_body <span style="color:#f92672">=</span> body</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BodyBuilder</span>:
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>_body <span style="color:#f92672">=</span> [] 

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(self, value):
        self<span style="color:#f92672">.</span>_body<span style="color:#f92672">.</span>append(value)
        <span style="color:#66d9ef">return</span> self

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">header</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>_header

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>status(<span style="color:#ae81ff">200</span>)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">status</span>(self, code):
        ret <span style="color:#f92672">=</span> {}
        ret[<span style="color:#e6db74">&#39;status&#39;</span>] <span style="color:#f92672">=</span> code
        ret[<span style="color:#e6db74">&#39;header&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_header<span style="color:#f92672">.</span>__dict__<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;_header&#39;</span>)
        ret[<span style="color:#e6db74">&#39;body&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_body
        <span style="color:#66d9ef">return</span> ret

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_header</span>(self, header):
        self<span style="color:#f92672">.</span>_header <span style="color:#f92672">=</span> header</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ResponseBuilder</span>:

    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>__header <span style="color:#f92672">=</span> HeaderBuilder()
        self<span style="color:#f92672">.</span>__body <span style="color:#f92672">=</span> BodyBuilder()
        self<span style="color:#f92672">.</span>__body<span style="color:#f92672">.</span>set_header(self<span style="color:#f92672">.</span>__header)
        self<span style="color:#f92672">.</span>__header<span style="color:#f92672">.</span>set_body(self<span style="color:#f92672">.</span>__body)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">header</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>__header

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">body</span>(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>__body</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    <span style="color:#66d9ef">print</span>(ResponseBuilder()
            <span style="color:#f92672">.</span>header()
                <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;Access-Control-Allow-Origin&#39;</span>, <span style="color:#e6db74">&#39;*&#39;</span>)
                <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;Accept&#39;</span>, <span style="color:#e6db74">&#39;*&#39;</span>)
            <span style="color:#f92672">.</span>body()
                <span style="color:#f92672">.</span>add(json<span style="color:#f92672">.</span>dumps(<span style="color:#e6db74">&#39;hello&#39;</span>, default<span style="color:#f92672">=</span>str))
            <span style="color:#f92672">.</span>status(<span style="color:#ae81ff">204</span>))

    <span style="color:#66d9ef">print</span>(ResponseBuilder()
            <span style="color:#f92672">.</span>header()
                <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;Age&#39;</span>, <span style="color:#e6db74">&#39;12&#39;</span>)
                <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;Accept&#39;</span>, <span style="color:#e6db74">&#39;*&#39;</span>)
            <span style="color:#f92672">.</span>body()
                <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;message comes here!&#39;</span>)
            <span style="color:#f92672">.</span>header()
                <span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;Access-Control-Allow-Origin&#39;</span>, <span style="color:#e6db74">&#39;*&#39;</span>)
            <span style="color:#f92672">.</span>build()) <span style="color:#75715e"># status is default to 200</span></code></pre></div>
<p>All these approaches are found in <a href="https://github.com/torokmark/builders_in_python">https://github.com/torokmark/builders_in_python</a></p>

  </div>
</div>

      <footer>
        <hr>
        <small>
          &copy; 2019 .
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> using the <a href="https://github.com/arjunkrishnababu96/basics" target="_blank">Basics</a> theme.
        </small>
      </footer>
    </div> 

    
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
  </body>
</html>

